---
import { getTerminalPS } from '../utils/terminal';

const heading = getTerminalPS(Astro.url.pathname);
---

<header class="mb-6 flex flex-col items-start justify-end min-h-[8rem]">
    <div class="flex flex-col items-start gap-1" id="ps-history"></div>
    <h1 class="mt-[0.3rem]" id="ps-current">{heading}</h1>
</header>

<script>
    import { getPSHistory, getCurrentLocation } from '../scripts/ps-history';

    function render() {
        const history = getPSHistory(5);
        const location = getCurrentLocation();

        const historyContainer = document.getElementById('ps-history');
        const currentEl = document.getElementById('ps-current');

        if (historyContainer) {
            historyContainer.innerHTML = history
                .map(entry => `<span class="text-sm opacity-40">${entry}</span>`)
                .join('');
        }

        if (currentEl) {
            currentEl.textContent = `wet333@PC:${location}$`;
        }
    }

    render();
    document.body.style.opacity = '1';
    window.addEventListener('ps-history-updated', render);
</script>
